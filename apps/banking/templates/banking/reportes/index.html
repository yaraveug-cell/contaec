{% extends 'base.html' %}
{% load static %}

{% block title %}Reportes de Conciliación Bancaria{% endblock %}

{% block extra_css %}
<link href="{% static 'css/banking.css' %}" rel="stylesheet">
<style>
.reportes-header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 2rem;
    border-radius: 15px;
    margin-bottom: 2rem;
    box-shadow: 0 8px 32px rgba(0,0,0,0.1);
}

.reporte-card {
    background: white;
    border-radius: 15px;
    padding: 2rem;
    margin-bottom: 2rem;
    box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    transition: all 0.3s ease;
    cursor: pointer;
    border-left: 5px solid transparent;
}

.reporte-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 30px rgba(0,0,0,0.15);
    border-left-color: var(--color);
}

.reporte-esencial {
    --color: #28a745;
}

.reporte-avanzado {
    --color: #007bff;
}

.reporte-gerencial {
    --color: #6f42c1;
}

.fase-badge {
    display: inline-block;
    padding: 0.25rem 0.75rem;
    border-radius: 15px;
    font-size: 0.75rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.fase-1 {
    background: linear-gradient(45deg, #28a745, #20c997);
    color: white;
}

.fase-2 {
    background: linear-gradient(45deg, #007bff, #0056b3);
    color: white;
}

.fase-3 {
    background: linear-gradient(45deg, #6f42c1, #5a32a0);
    color: white;
}

.reporte-descripcion {
    margin: 1rem 0;
    color: #6c757d;
    line-height: 1.6;
}

.reporte-caracteristicas {
    list-style: none;
    padding: 0;
    margin: 1rem 0;
}

.reporte-caracteristicas li {
    padding: 0.25rem 0;
    position: relative;
    padding-left: 1.5rem;
}

.reporte-caracteristicas li:before {
    content: '✓';
    position: absolute;
    left: 0;
    color: #28a745;
    font-weight: bold;
}

.btn-reporte {
    background: linear-gradient(45deg, var(--color), transparent);
    border: 2px solid var(--color);
    color: var(--color);
    padding: 0.75rem 2rem;
    border-radius: 25px;
    font-weight: 500;
    text-decoration: none;
    transition: all 0.3s ease;
}

.btn-reporte:hover {
    background: var(--color);
    color: white;
    transform: translateY(-2px);
}

.menu-navegacion {
    background: white;
    border-radius: 15px;
    padding: 1.5rem;
    margin-bottom: 2rem;
    box-shadow: 0 4px 20px rgba(0,0,0,0.08);
}

.nav-item {
    margin: 0 0.5rem;
}

.nav-link-custom {
    padding: 0.75rem 1.5rem;
    border-radius: 25px;
    text-decoration: none;
    color: #6c757d;
    font-weight: 500;
    transition: all 0.3s ease;
}

.nav-link-custom:hover,
.nav-link-custom.active {
    background: linear-gradient(45deg, #007bff, #0056b3);
    color: white;
}
</style>
{% endblock %}

{% block content %}
<div class="container-fluid px-4">
    <!-- Header Principal -->
    <div class="reportes-header">
        <div class="d-flex justify-content-between align-items-center">
            <div>
                <h1 class="mb-2">
                    <i class="fas fa-chart-bar me-3"></i>
                    Reportes de Conciliación Bancaria
                </h1>
                <p class="mb-0 opacity-75">
                    Sistema integral de reportes para análisis y control de conciliación bancaria
                </p>
            </div>
            <div class="text-end">
                <p class="mb-1">Sistema: <strong>ContaEC v1.0</strong></p>
                <p class="mb-0">Módulo: <strong>Banking & Reconciliation</strong></p>
            </div>
        </div>
    </div>

    <!-- Menú de Navegación -->
    <div class="menu-navegacion">
        <nav class="d-flex justify-content-center">
            <div class="nav-item">
                <a href="{% url 'banking:conciliacion' %}" class="nav-link-custom">
                    <i class="fas fa-balance-scale me-2"></i>Conciliación Manual
                </a>
            </div>
            <div class="nav-item">
                <a href="{% url 'banking:estado_conciliacion' %}" class="nav-link-custom">
                    <i class="fas fa-chart-pie me-2"></i>Estado por Cuenta
                </a>
            </div>
            <div class="nav-item">
                <a href="{% url 'banking:diferencias_no_conciliadas' %}" class="nav-link-custom">
                    <i class="fas fa-exclamation-triangle me-2"></i>Diferencias
                </a>
            </div>
            <div class="nav-item">
                <a href="{% url 'banking:extracto_conciliacion_mensual' %}" class="nav-link-custom">
                    <i class="fas fa-calendar-alt me-2"></i>Extracto Mensual
                </a>
            </div>
            <div class="nav-item">
                <a href="{% url 'admin:banking_bankaccount_changelist' %}" class="nav-link-custom">
                    <i class="fas fa-cogs me-2"></i>Configuración
                </a>
            </div>
        </nav>
    </div>

    <!-- FASE 1: Reportes Esenciales (IMPLEMENTADOS) -->
    <div class="row">
        <div class="col-12 mb-3">
            <h3><i class="fas fa-star me-2 text-success"></i>FASE 1: Reportes Esenciales</h3>
            <p class="text-muted">Reportes fundamentales para el control diario de conciliación bancaria</p>
        </div>

        <div class="col-lg-4 col-md-6">
            <div class="reporte-card reporte-esencial" data-url="{% url 'banking:estado_conciliacion' %}">
                <div class="d-flex justify-content-between align-items-start mb-3">
                    <h5 class="mb-0">
                        <i class="fas fa-chart-pie me-2"></i>
                        Estado de Conciliación por Cuenta
                    </h5>
                    <span class="fase-badge fase-1">Fase 1</span>
                </div>
                
                <p class="reporte-descripcion">
                    Resumen ejecutivo del estado actual de conciliación de todas las cuentas bancarias de la empresa.
                </p>
                
                <ul class="reporte-caracteristicas">
                    <li>Vista consolidada por cuenta bancaria</li>
                    <li>Porcentajes de conciliación en tiempo real</li>
                    <li>Identificación de cuentas que requieren atención</li>
                    <li>Montos conciliados vs pendientes</li>
                </ul>
                
                <div class="text-center">
                    <a href="{% url 'banking:estado_conciliacion' %}" class="btn-reporte" style="--color: #28a745">
                        <i class="fas fa-eye me-2"></i>Ver Reporte
                    </a>
                </div>
            </div>
        </div>

        <div class="col-lg-4 col-md-6">
            <div class="reporte-card reporte-esencial" data-url="{% url 'banking:diferencias_no_conciliadas' %}">
                <div class="d-flex justify-content-between align-items-start mb-3">
                    <h5 class="mb-0">
                        <i class="fas fa-exclamation-triangle me-2"></i>
                        Diferencias No Conciliadas
                    </h5>
                    <span class="fase-badge fase-1">Fase 1</span>
                </div>
                
                <p class="reporte-descripcion">
                    Listado detallado de todas las transacciones e items de extracto que no han sido conciliados.
                </p>
                
                <ul class="reporte-caracteristicas">
                    <li>Filtrado por cuenta y fechas</li>
                    <li>Transacciones del sistema vs extracto</li>
                    <li>Cálculo automático de diferencias</li>
                    <li>Acceso directo a conciliación manual</li>
                </ul>
                
                <div class="text-center">
                    <a href="{% url 'banking:diferencias_no_conciliadas' %}" class="btn-reporte" style="--color: #dc3545">
                        <i class="fas fa-search me-2"></i>Ver Diferencias
                    </a>
                </div>
            </div>
        </div>

        <div class="col-lg-4 col-md-6">
            <div class="reporte-card reporte-esencial" data-url="{% url 'banking:extracto_conciliacion_mensual' %}">
                <div class="d-flex justify-content-between align-items-start mb-3">
                    <h5 class="mb-0">
                        <i class="fas fa-calendar-alt me-2"></i>
                        Extracto de Conciliación Mensual
                    </h5>
                    <span class="fase-badge fase-1">Fase 1</span>
                </div>
                
                <p class="reporte-descripcion">
                    Reporte detallado mensual de conciliación para una cuenta específica con análisis completo.
                </p>
                
                <ul class="reporte-caracteristicas">
                    <li>Selección de cuenta, año y mes</li>
                    <li>Saldos inicial, final y diferencias</li>
                    <li>Listado completo de movimientos</li>
                    <li>Estadísticas de progreso</li>
                </ul>
                
                <div class="text-center">
                    <a href="{% url 'banking:extracto_conciliacion_mensual' %}" class="btn-reporte" style="--color: #007bff">
                        <i class="fas fa-calendar me-2"></i>Generar Extracto
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- FASE 2: Reportes Avanzados (PRÓXIMAMENTE) -->
    <div class="row mt-5">
        <div class="col-12 mb-3">
            <h3><i class="fas fa-rocket me-2 text-primary"></i>FASE 2: Reportes Avanzados</h3>
            <p class="text-muted">Análisis avanzados y herramientas de optimización (Próximamente)</p>
        </div>

        <div class="col-lg-4 col-md-6">
            <div class="reporte-card reporte-avanzado" style="opacity: 0.6;">
                <div class="d-flex justify-content-between align-items-start mb-3">
                    <h5 class="mb-0">
                        <i class="fas fa-chart-line me-2"></i>
                        Tendencias de Conciliación
                    </h5>
                    <span class="fase-badge fase-2">Fase 2</span>
                </div>
                
                <p class="reporte-descripcion">
                    Análisis histórico de tendencias y patrones en el proceso de conciliación bancaria.
                </p>
                
                <div class="text-center">
                    <button class="btn-reporte" style="--color: #007bff" disabled>
                        <i class="fas fa-lock me-2"></i>Próximamente
                    </button>
                </div>
            </div>
        </div>

        <div class="col-lg-4 col-md-6">
            <div class="reporte-card reporte-avanzado" style="opacity: 0.6;">
                <div class="d-flex justify-content-between align-items-start mb-3">
                    <h5 class="mb-0">
                        <i class="fas fa-bell me-2"></i>
                        Alertas y Excepciones
                    </h5>
                    <span class="fase-badge fase-2">Fase 2</span>
                </div>
                
                <p class="reporte-descripcion">
                    Sistema de alertas automáticas para diferencias significativas y excepciones.
                </p>
                
                <div class="text-center">
                    <button class="btn-reporte" style="--color: #ffc107" disabled>
                        <i class="fas fa-lock me-2"></i>Próximamente
                    </button>
                </div>
            </div>
        </div>

        <div class="col-lg-4 col-md-6">
            <div class="reporte-card reporte-avanzado" style="opacity: 0.6;">
                <div class="d-flex justify-content-between align-items-start mb-3">
                    <h5 class="mb-0">
                        <i class="fas fa-robot me-2"></i>
                        Conciliación Automática
                    </h5>
                    <span class="fase-badge fase-2">Fase 2</span>
                </div>
                
                <p class="reporte-descripción">
                    Herramientas de matching inteligente y conciliación automática por reglas.
                </p>
                
                <div class="text-center">
                    <button class="btn-reporte" style="--color: #17a2b8" disabled>
                        <i class="fas fa-lock me-2"></i>Próximamente
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// Marcar link activo en navegación
document.addEventListener('DOMContentLoaded', function() {
    const currentPath = window.location.pathname;
    const navLinks = document.querySelectorAll('.nav-link-custom');
    
    navLinks.forEach(link => {
        if (link.getAttribute('href') === currentPath) {
            link.classList.add('active');
        }
    });
});

// Animaciones al cargar y manejo de clicks
document.addEventListener('DOMContentLoaded', function() {
    const cards = document.querySelectorAll('.reporte-card');
    
    // Animaciones de carga
    cards.forEach((card, index) => {
        setTimeout(() => {
            card.style.opacity = '0';
            card.style.transform = 'translateY(30px)';
            card.style.transition = 'all 0.6s ease';
            
            // Trigger animation
            setTimeout(() => {
                card.style.opacity = card.style.opacity === '0.6' ? '0.6' : '1';
                card.style.transform = 'translateY(0)';
            }, 50);
        }, index * 150);
        
        // Manejo de clicks con data-url
        if (card.hasAttribute('data-url')) {
            card.style.cursor = 'pointer';
            card.addEventListener('click', function() {
                const url = this.getAttribute('data-url');
                if (url) {
                    window.location.href = url;
                }
            });
        }
    });
});
</script>
{% endblock %}